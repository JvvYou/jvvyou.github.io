
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="容器网络理解">
      
      
      
        <link rel="canonical" href="https://jvvyou.github.io/blog/2024/02/21/%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E7%90%86%E8%A7%A3/">
      
      
        <link rel="prev" href="../../../01/29/simpleui%20layer%E8%87%AA%E5%8A%A8%E5%8A%A0%E8%BD%BD/">
      
      
        <link rel="next" href="../../../06/03/%E5%BD%93%E6%88%91%E9%81%87%E5%88%B0%E4%BA%86%E7%88%AC%E8%99%AB/">
      
      
      <link rel="icon" href="../../../../../assets/img/person/index_logo.jpeg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.30">
    
    
      
        <title>容器网络理解 - vv的小站</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-VGR40J3Y3P"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-VGR40J3Y3P",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-VGR40J3Y3P",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="容器网络理解 - vv的小站" >
      
        <meta  property="og:description"  content="容器网络理解" >
      
        <meta  property="og:image"  content="https://jvvyou.github.io/assets/images/social/blog/posts/k8s/容器网络理解.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://jvvyou.github.io/blog/2024/02/21/%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E7%90%86%E8%A7%A3/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="容器网络理解 - vv的小站" >
      
        <meta  name="twitter:description"  content="容器网络理解" >
      
        <meta  name="twitter:image"  content="https://jvvyou.github.io/assets/images/social/blog/posts/k8s/容器网络理解.png" >
      
    
    
  <!-- Add scripts that need to run before here -->
  
  <!-- Add scripts that need to run afterwards here -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6676480188236347"
     crossorigin="anonymous"></script>

   <link href="../../../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1veth-container-veth-host" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../../../.." title="vv的小站" class="md-header__button md-logo" aria-label="vv的小站" data-md-component="logo">
      
  <img src="../../../../../assets/img/person/index_logo.jpeg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            vv的小站
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              容器网络理解
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../.." class="md-tabs__link">
          
  
    
  
  首页

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../../" class="md-tabs__link">
          
  
    
  
  博客

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../language/%E6%B5%81%E7%95%85%E7%9A%84python%E7%AC%94%E8%AE%B0/" class="md-tabs__link">
          
  
    
  
  语言

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../../native/istio%E6%B5%81%E9%87%8F%E7%AE%A1%E7%90%86-vs/" class="md-tabs__link">
          
  
    
  
  云原生

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="vv的小站" class="md-nav__button md-logo" aria-label="vv的小站" data-md-component="logo">
      
  <img src="../../../../../assets/img/person/index_logo.jpeg" alt="logo">

    </a>
    vv的小站
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../.." class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    首页
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            首页
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    博客
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            博客
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    归档
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            归档
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2024/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2024
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../archive/2023/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2023
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    分类
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            分类
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/devops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    devops
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    docker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/k8s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    k8s
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/life/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    life
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/monitor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    monitor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../../../category/sys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sys
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    语言
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            语言
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../language/%E6%B5%81%E7%95%85%E7%9A%84python%E7%AC%94%E8%AE%B0/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    流畅的python
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    云原生
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            云原生
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../native/istio%E6%B5%81%E9%87%8F%E7%AE%A1%E7%90%86-vs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    istio VirtualService 配置示例
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../native/istio%E6%B5%81%E9%87%8F%E7%AE%A1%E7%90%86-dr/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    istio DestinationRule
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../native/istio-gateway/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    istio gateway 试玩
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../native/istio-envoy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    istio envoy 访问外部服务
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../native/istio-%E5%AE%89%E5%85%A8%E6%8E%88%E6%9D%83/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    istio 安全 授权
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../native/istio-%E5%88%86%E5%B8%83%E5%BC%8F%E8%BF%BD%E8%B8%AA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    istio 分布式追踪
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../native/istio-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    istio 安全 身份验证策略
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1veth-container-veth-host" class="md-nav__link">
    <span class="md-ellipsis">
      1、veth-container -&gt; veth-host
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2veth-host-docker0" class="md-nav__link">
    <span class="md-ellipsis">
      2、veth-host -&gt; 网络桥接（如docker0）
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3docker0-" class="md-nav__link">
    <span class="md-ellipsis">
      3、网络桥接（如docker0）-&gt; 宿主机路由
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-iptables" class="md-nav__link">
    <span class="md-ellipsis">
      4、宿主机路由 -&gt; iptables
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4、宿主机路由 -> iptables">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#forward" class="md-nav__link">
    <span class="md-ellipsis">
      FORWARD 规则：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      DOCKER 链：
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-isolation-stage" class="md-nav__link">
    <span class="md-ellipsis">
      DOCKER-ISOLATION-STAGE 链：
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
                  <span class="md-ellipsis">
                    回到主页
                  </span>
                </a>
              </div>
            </div>
            
              <div class="md-post__authors md-typeset">
                
                  <div class="md-profile md-post__profile">
                    <span class="md-author md-author--long">
                      <img src="../../../../img/person/index_logo.jpeg" alt="jvvyou">
                    </span>
                    <span class="md-profile__description">
                      <strong>
                        
                          <a href="https://vvxx.js.cn">jvvyou</a>
                        
                      </strong>
                      <br>
                      享受生活
                    </span>
                  </div>
                
              </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    元数据
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5v-5Z"/></svg>
                        <time datetime="2024-02-21 00:00:00" class="md-ellipsis">2024年2月21日星期三</time>
                      </div>
                    </li>
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15 13h1.5v2.82l2.44 1.41-.75 1.3L15 16.69V13m4-5H5v11h4.67c-.43-.91-.67-1.93-.67-3a7 7 0 0 1 7-7c1.07 0 2.09.24 3 .67V8M5 21a2 2 0 0 1-2-2V5c0-1.11.89-2 2-2h1V1h2v2h8V1h2v2h1a2 2 0 0 1 2 2v6.1c1.24 1.26 2 2.99 2 4.9a7 7 0 0 1-7 7c-1.91 0-3.64-.76-4.9-2H5m11-9.85A4.85 4.85 0 0 0 11.15 16c0 2.68 2.17 4.85 4.85 4.85A4.85 4.85 0 0 0 20.85 16c0-2.68-2.17-4.85-4.85-4.85Z"/></svg>
                          <time datetime="2024-02-21 00:00:00" class="md-ellipsis">2024年2月21日星期三</time>
                        </div>
                      </li>
                    
                    
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3H9m3 2 4 13 3-1-4-13-3 1M5 5v13h3V5H5M3 19v2h18v-2H3Z"/></svg>
                          <span class="md-ellipsis">
                            分类于
                            
                              <a href="../../../../category/docker/">docker</a></span>
                        </div>
                      </li>
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7h1.5Z"/></svg>
                          <span class="md-ellipsis">
                            
                              需要 5 分钟阅读时间
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        <!--
Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to
deal in the Software without restriction, including without limitation the
rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
sell copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
IN THE SOFTWARE.
-->

<!-- Tags -->


  

<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">docker</span>
    
  
    
    
    
      <span class="md-tag">iptables</span>
    
  
</nav>


<!-- Actions -->


<!--
Hack: check whether the content contains a h1 headline. If it doesn't, the
page title (or respectively site name) is used as the main headline.
-->

<h1>容器网络理解</h1>


<!-- Page content -->
<p>容器网络理解。</p>
<!-- more -->

<p>容器中的应用生成网络请求 -&gt; veth-container -&gt; veth-host -&gt; 网络桥接（如docker0）-&gt; 宿主机路由 -&gt; iptables -&gt;物理网卡 -&gt; 外部网络</p>
<h2 id="1veth-container-veth-host">1、veth-container -&gt; veth-host</h2>
<p>Docker 或 Kubernetes 创建一对虚拟网卡（veth pair），一端放在宿主机上（称作veth-host），另一端放在容器中（称作veth-container）。
宿主机上的那端虚拟网卡被连接到一个网络桥接（如 Docker 默认的docker0桥），这个桥接允许网络包在各个容器以及宿主机之间转发。</p>
<p>这种机制的工作流程如下：</p>
<ol>
<li>
<p>当Docker容器启动时，Docker服务会创建一对<code>veth</code>接口。假设对于特定的容器创建的<code>veth</code>接口被称为<code>vethXXX</code>和<code>vethYYY</code>。</p>
</li>
<li>
<p><code>vethXXX</code>这一端被放入容器的网络命名空间，并通常被命名为<code>eth0</code>，这样容器内部的进程就可以通过这个接口发送和接收网络数据。而<code>vethYYY</code>这端留在宿主机的全局网络命名空间中。</p>
</li>
<li>
<p><code>vethYYY</code>这端接口将被连接到Docker的虚拟网桥上，例如默认的网桥<code>docker0</code>。这个虚拟网桥允许容器之间在相同宿主机上相互通信，同时也允许容器与宿主机之间的通信。</p>
</li>
</ol>
<p><a class="glightbox" href="../../../../img/20240221/image.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="veth-container -&gt; veth-host" src="../../../../img/20240221/image.png" /></a></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="o">[</span>root@jenkins-master<span class="w"> </span>~<span class="o">]</span><span class="c1"># docker inspect -f &#39;{{.State.Pid}}&#39; nginx-dd</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="m">29044</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="o">[</span>root@jenkins-master<span class="w"> </span>~<span class="o">]</span><span class="c1"># nsenter -t 29044 -n ip addr</span>
</span></code></pre></div>
<h2 id="2veth-host-docker0">2、veth-host -&gt; 网络桥接（如docker0）</h2>
<p><a class="glightbox" href="../../../../img/20240221/image2.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="veth-host -&gt; 网络桥接" src="../../../../img/20240221/image2.png" /></a>
 veth pair 在宿主机上的接口加入网桥中。</p>
<h2 id="3docker0-">3、网络桥接（如docker0）-&gt; 宿主机路由</h2>
<p>在 CentOS 系统中，网桥 (<code>bridge</code>) 是一个工作在 OSI 模型的第二层（数据链路层）的设备，它负责连接两个或多个网络段，使它们表现得像是同一网络。它通过 MAC 地址来转发流量；然而，当我们在网桥上配置了一个 IP 地址时，这个网桥也可以参与第三层（网络层）的操作，比如路由决策。</p>
<p>这种配置允许网桥设备参与到操作系统的 IP 路由决策中。一旦一个网桥配置了 IP 地址，就跟其他任何网络接口一样，它会出现在操作系统的路由表中。路由表决定了 IP 数据包如何从一个接口（可以是物理接口，也可以是逻辑接口如网桥）被路由到另一个接口。</p>
<p>网桥上配置的 IP 地址使得网桥可以：</p>
<ul>
<li>接收发往其 IP 地址的流量。</li>
<li>发送数据包到网络上，这些数据包会经路由表中定义的下一跳路由走向目的地。</li>
<li>作为网桥上其他设备的网关。</li>
</ul>
<p>通常，当一个桥接网络中的设备要发送一个数据包到另一个网络段（可能是通过互联网）时，数据包会送到网桥设备，从那里根据 CentOS 的路由表决策来确定下一步行动。如果路由表中有匹配该目的地的路由，数据包将根据这个路由进行转发。</p>
<p>这是一个简化的例子：</p>
<ol>
<li>设备A（连接到网桥 br0 网络）发送数据包到设备B（互联网上的某个IP地址）。</li>
<li>数据包首先到达网桥 br0。</li>
<li>如果 br0 有一个 IP 地址，它会检查它的路由表来决定如何处理这个数据包。</li>
<li>如果路由表指示它应该通过某个物理接口发送（比如 eth0），它会将数据包发到这个接口，该接口再把数据包送到外部网络。</li>
</ol>
<p>所以即便网桥是第二层设备，一旦配置了 IP 地址，它就能够利用操作系统的路由表进行第三层的路由。这也是为什么在一些设置中，网桥可以作为一个虚拟机或容器环境中的默认网关。</p>
<p><a class="glightbox" href="../../../../img/20240221/image3.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="网络桥接 -&gt; 宿主机路由" src="../../../../img/20240221/image3.png" /></a></p>
<h2 id="4-iptables">4、宿主机路由 -&gt; iptables</h2>
<p>路由表负责决定本地生成的网络数据包该如何在宿主机的不同网络接口之间转发，是否要转发到物理网卡，或者是留在本地处理。
iptables负责对经过宿主机的数据包进行检查，基于一系列的规则进行修改（比如NAT），或者决定是否允许特定的数据流通过。</p>
<p><a class="glightbox" href="../../../../img/20240221/image4.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="宿主机路由 -&gt; iptables" src="../../../../img/20240221/image4.png" /></a></p>
<details class="filter表">
<summary>Filter表</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>*filter
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>:INPUT<span class="w"> </span>ACCEPT<span class="w"> </span><span class="o">[</span><span class="m">244972180</span>:39059491022<span class="o">]</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>:FORWARD<span class="w"> </span>DROP<span class="w"> </span><span class="o">[</span><span class="m">0</span>:0<span class="o">]</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>:OUTPUT<span class="w"> </span>ACCEPT<span class="w"> </span><span class="o">[</span><span class="m">439290180</span>:389638265797<span class="o">]</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>:DOCKER<span class="w"> </span>-<span class="w"> </span><span class="o">[</span><span class="m">0</span>:0<span class="o">]</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>:DOCKER-ISOLATION-STAGE-1<span class="w"> </span>-<span class="w"> </span><span class="o">[</span><span class="m">0</span>:0<span class="o">]</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>:DOCKER-ISOLATION-STAGE-2<span class="w"> </span>-<span class="w"> </span><span class="o">[</span><span class="m">0</span>:0<span class="o">]</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>:DOCKER-USER<span class="w"> </span>-<span class="w"> </span><span class="o">[</span><span class="m">0</span>:0<span class="o">]</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-j<span class="w"> </span>DOCKER-USER
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-j<span class="w"> </span>DOCKER-ISOLATION-STAGE-1
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-m<span class="w"> </span>conntrack<span class="w"> </span>--ctstate<span class="w"> </span>RELATED,ESTABLISHED<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-j<span class="w"> </span>DOCKER
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-i<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>!<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-i<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-o<span class="w"> </span>docker0<span class="w"> </span>-m<span class="w"> </span>conntrack<span class="w"> </span>--ctstate<span class="w"> </span>RELATED,ESTABLISHED<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-o<span class="w"> </span>docker0<span class="w"> </span>-j<span class="w"> </span>DOCKER
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-i<span class="w"> </span>docker0<span class="w"> </span>!<span class="w"> </span>-o<span class="w"> </span>docker0<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>-A<span class="w"> </span>FORWARD<span class="w"> </span>-i<span class="w"> </span>docker0<span class="w"> </span>-o<span class="w"> </span>docker0<span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>-A<span class="w"> </span>DOCKER<span class="w"> </span>-d<span class="w"> </span><span class="m">172</span>.18.0.2/32<span class="w"> </span>!<span class="w"> </span>-i<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>-m<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">80</span><span class="w"> </span>-j<span class="w"> </span>ACCEPT
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>-A<span class="w"> </span>DOCKER-ISOLATION-STAGE-1<span class="w"> </span>-i<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>!<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-j<span class="w"> </span>DOCKER-ISOLATION-STAGE-2
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>-A<span class="w"> </span>DOCKER-ISOLATION-STAGE-1<span class="w"> </span>-i<span class="w"> </span>docker0<span class="w"> </span>!<span class="w"> </span>-o<span class="w"> </span>docker0<span class="w"> </span>-j<span class="w"> </span>DOCKER-ISOLATION-STAGE-2
</span><span id="__span-1-22"><a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>-A<span class="w"> </span>DOCKER-ISOLATION-STAGE-1<span class="w"> </span>-j<span class="w"> </span>RETURN
</span><span id="__span-1-23"><a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>-A<span class="w"> </span>DOCKER-ISOLATION-STAGE-2<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-j<span class="w"> </span>DROP
</span><span id="__span-1-24"><a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>-A<span class="w"> </span>DOCKER-ISOLATION-STAGE-2<span class="w"> </span>-o<span class="w"> </span>docker0<span class="w"> </span>-j<span class="w"> </span>DROP
</span><span id="__span-1-25"><a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>-A<span class="w"> </span>DOCKER-ISOLATION-STAGE-2<span class="w"> </span>-j<span class="w"> </span>RETURN
</span><span id="__span-1-26"><a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>-A<span class="w"> </span>DOCKER-USER<span class="w"> </span>-j<span class="w"> </span>RETURN
</span><span id="__span-1-27"><a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>COMMIT
</span><span id="__span-1-28"><a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a><span class="c1"># Completed on Tue Feb 20 15:06:32 2024</span>
</span></code></pre></div>
<h3 id="forward">FORWARD 规则：</h3>
<ol>
<li>
<p><code>-A FORWARD -j DOCKER-USER</code>：
  将所有 FORWARD 链的流量定向到名为 DOCKER-USER 的自定义链。这样做是为了给用户提供在自定义链中插入他们自己的 FORWARD 规则的机会，不通过 Docker 自动生成的规则。</p>
</li>
<li>
<p><code>-A FORWARD -j DOCKER-ISOLATION-STAGE-1</code>：
  此规则把流量送到隔离阶段链。Docker 使用这些规则来阻止不同网络的容器之间的直接通信，实施网络隔离。</p>
</li>
<li>
<p><code>-A FORWARD -o br-40d652e0aac8 -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT</code>：
  此规则允许与已经建立或相关联的连接发出的流量通过 Docker 网桥 <code>br-40d652e0aac8</code>。</p>
</li>
<li>
<p><code>-A FORWARD -o br-40d652e0aac8 -j DOCKER</code>：
  对于发出的流量，如果它是从网桥 <code>br-40d652e0aac8</code> 传出的，就跳转到 DOCKER 链。</p>
</li>
<li>
<p><code>-A FORWARD -i br-40d652e0aac8 ! -o br-40d652e0aac8 -j ACCEPT</code>：
  这条规则允许所有进入网桥 <code>br-40d652e0aac8</code> 且不是从该网桥传出的流量。</p>
</li>
<li>
<p><code>-A FORWARD -i br-40d652e0aac8 -o br-40d652e0aac8 -j ACCEPT</code>：
  允许所有从网桥 <code>br-40d652e0aac8</code> 进来同时也从同一网桥出去的流量。这样的流量发生在同一 Docker 网桥内部的不同容器之间。</p>
</li>
</ol>
<h3 id="docker">DOCKER 链：</h3>
<ol>
<li><code>-A DOCKER -d 172.18.0.2/32 ! -i br-40d652e0aac8 -o br-40d652e0aac8 -p tcp -m tcp --dport 80 -j ACCEPT</code>：
  此规则允许任何不是来自网桥 <code>br-40d652e0aac8</code> 的流量到达 IP 为 172.18.0.2 的设备（容器）上的 TCP 端口 80。</li>
</ol>
<h3 id="docker-isolation-stage">DOCKER-ISOLATION-STAGE 链：</h3>
<ol>
<li>
<p><code>-A DOCKER-ISOLATION-STAGE-1 -i br-40d652e0aac8 ! -o br-40d652e0aac8 -j DOCKER-ISOLATION-STAGE-2</code>：
  如果流量是从网桥 <code>br-40d652e0aac8</code> 进来且不是传出同一网桥的，则定向到隔离阶段 2。</p>
</li>
<li>
<p><code>-A DOCKER-ISOLATION-STAGE-1 -i docker0 ! -o docker0 -j DOCKER-ISOLATION-STAGE-2</code>：
  对于进入默认的 Docker 网桥 <code>docker0</code> 而且不是离开它的流量，跳转到隔离阶段 2。</p>
</li>
<li>
<p><code>-A DOCKER-ISOLATION-STAGE-1 -j RETURN</code>：
    所有不符合隔离规则的流量结束隔离阶段 1 并返回到 FORWARD 。</p>
</li>
<li>
<p><code>-A DOCKER-ISOLATION-STAGE-2 -o br-40d652e0aac8 -j DROP</code>：
    丢弃所有传出网桥 <code>br-40d652e0aac8</code> 的流量，以确保网络隔离。</p>
</li>
<li>
<p><code>-A DOCKER-ISOLATION-STAGE-2 -o docker0 -j DROP</code>：
    丢弃所有传出网桥 <code>docker0</code> 的流量，同样为了网络隔</p>
</li>
</ol>
</details>
<p><a class="glightbox" href="../../../../img/20240221/image5.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="nat" src="../../../../img/20240221/image5.png" /></a></p>
<details class="nat表">
<summary>Nat表</summary>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="c1"># Generated by iptables-save v1.4.21 on Tue Feb 20 15:06:32 2024</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>*nat
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>:PREROUTING<span class="w"> </span>ACCEPT<span class="w"> </span><span class="o">[</span><span class="m">6782554</span>:235185454<span class="o">]</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>:INPUT<span class="w"> </span>ACCEPT<span class="w"> </span><span class="o">[</span><span class="m">6770892</span>:234485508<span class="o">]</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>:OUTPUT<span class="w"> </span>ACCEPT<span class="w"> </span><span class="o">[</span><span class="m">10758364</span>:662367917<span class="o">]</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>:POSTROUTING<span class="w"> </span>ACCEPT<span class="w"> </span><span class="o">[</span><span class="m">10792762</span>:664241249<span class="o">]</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>:DOCKER<span class="w"> </span>-<span class="w"> </span><span class="o">[</span><span class="m">0</span>:0<span class="o">]</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>-A<span class="w"> </span>PREROUTING<span class="w"> </span>-m<span class="w"> </span>addrtype<span class="w"> </span>--dst-type<span class="w"> </span>LOCAL<span class="w"> </span>-j<span class="w"> </span>DOCKER
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>-A<span class="w"> </span>OUTPUT<span class="w"> </span>!<span class="w"> </span>-d<span class="w"> </span><span class="m">127</span>.0.0.0/8<span class="w"> </span>-m<span class="w"> </span>addrtype<span class="w"> </span>--dst-type<span class="w"> </span>LOCAL<span class="w"> </span>-j<span class="w"> </span>DOCKER
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>-A<span class="w"> </span>POSTROUTING<span class="w"> </span>-s<span class="w"> </span><span class="m">172</span>.18.0.0/16<span class="w"> </span>!<span class="w"> </span>-o<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-j<span class="w"> </span>MASQUERADE
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>-A<span class="w"> </span>POSTROUTING<span class="w"> </span>-s<span class="w"> </span><span class="m">172</span>.17.0.0/16<span class="w"> </span>!<span class="w"> </span>-o<span class="w"> </span>docker0<span class="w"> </span>-j<span class="w"> </span>MASQUERADE
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>-A<span class="w"> </span>POSTROUTING<span class="w"> </span>-s<span class="w"> </span><span class="m">172</span>.18.0.2/32<span class="w"> </span>-d<span class="w"> </span><span class="m">172</span>.18.0.2/32<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>-m<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">80</span><span class="w"> </span>-j<span class="w"> </span>MASQUERADE
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>-A<span class="w"> </span>DOCKER<span class="w"> </span>-i<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-j<span class="w"> </span>RETURN
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>-A<span class="w"> </span>DOCKER<span class="w"> </span>-i<span class="w"> </span>docker0<span class="w"> </span>-j<span class="w"> </span>RETURN
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>-A<span class="w"> </span>DOCKER<span class="w"> </span>!<span class="w"> </span>-i<span class="w"> </span>br-40d652e0aac8<span class="w"> </span>-p<span class="w"> </span>tcp<span class="w"> </span>-m<span class="w"> </span>tcp<span class="w"> </span>--dport<span class="w"> </span><span class="m">80</span><span class="w"> </span>-j<span class="w"> </span>DNAT<span class="w"> </span>--to-destination<span class="w"> </span><span class="m">172</span>.18.0.2:80
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>COMMIT
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="c1"># Completed on Tue Feb 20 15:06:32 2024</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="c1"># Generated by iptables-save v1.4.21 on Tue Feb 20 15:06:32 2024</span>
</span></code></pre></div>
<p>这些规则似乎配置自 Docker 以管理容器的网络通信。下面我将一一解释它们的含义：</p>
<ol>
<li><code>-A PREROUTING -m addrtype --dst-type LOCAL -j DOCKER</code></li>
<li>
<p>这条规则添加到 <code>PREROUTING</code> 链，它匹配所有目标类型为 <code>LOCAL</code> 的数据包，并将它们跳转到一个名为 <code>DOCKER</code> 的自定义链（这是 Docker 使用的）。</p>
</li>
<li>
<p><code>-A OUTPUT ! -d 127.0.0.0/8 -m addrtype --dst-type LOCAL -j DOCKER</code></p>
</li>
<li>
<p>这条规则添加到 <code>OUTPUT</code> 链，它表示如果输出数据包的目的地址不是本地回环地址（localhost，也就是127.0.0.0/8之外），并且目的类型为 <code>LOCAL</code>，也将它们跳转到 <code>DOCKER</code> 链。</p>
</li>
<li>
<p><code>-A POSTROUTING -s 172.18.0.0/16 ! -o br-40d652e0aac8 -j MASQUERADE</code></p>
</li>
<li>
<p>这条规则添加到 <code>POSTROUTING</code> 链，它会对源地址为 <code>172.18.0.0/16</code> 的数据包，并且不是从接口 <code>br-40d652e0aac8</code> 出去的，执行 <code>MASQUERADE</code> 动作。<code>MASQUERADE</code> 类似于SNAT，但源IP会根据出口接口的IP动态变化，常用于动态IP场景，如拨号连接互联网。Docker 使用这个来允许容器访问外部网络。</p>
</li>
<li>
<p><code>-A POSTROUTING -s 172.17.0.0/16 ! -o docker0 -j MASQUERADE</code></p>
</li>
<li>
<p>与第3点类似，这个规则应用于源地址为 <code>172.17.0.0/16</code> 的数据包，不是从接口 <code>docker0</code> 出去的。</p>
</li>
<li>
<p><code>-A POSTROUTING -s 172.18.0.2/32 -d 172.18.0.2/32 -p tcp -m tcp --dport 80 -j MASQUERADE</code></p>
</li>
<li>
<p>该规则针对从单个IP <code>172.18.0.2</code> 发出、目的地也是此IP、以及目的端口为80的TCP数据包，做<code>MASQUERADE</code>处理。这通常用于处理容器与自己发起跟自己的连接。</p>
</li>
<li>
<p><code>-A DOCKER -i br-40d652e0aac8 -j RETURN</code></p>
</li>
<li>
<p>对于通过 <code>br-40d652e0aac8</code> 接口进入的数据包，这条规则在 <code>DOCKER</code> 链中直接返回，即不做特殊处理。</p>
</li>
<li>
<p><code>-A DOCKER -i docker0 -j RETURN</code></p>
</li>
<li>
<p>类似上一条规则，通过 <code>docker0</code> 网桥接口进入的数据包不做处理，直接返回。</p>
</li>
<li>
<p><code>-A DOCKER ! -i br-40d652e0aac8 -p tcp -m tcp --dport 80 -j DNAT --to-destination 172.18.0.2:80</code></p>
</li>
<li>该规则对非从 <code>br-40d652e0aac8</code> 接口进入、目的端口为80的TCP数据包，执行DNAT动作，修改目的地址为 <code>172.18.0.2:80</code>。这通常是在做端口转发，将到达宿主机某端口的数据包转发到特定容器的端口。</li>
</ol>
<p>以上规则集是 Docker 在宿主机上配置的一部分，以实现容器之间以及容器与外部网络之间的流畅通信。通过这些规则可以看出 Docker 使用 <code>iptables</code> 的定制链来处理容器网络的复杂性，而可识别性则由 Docker 本身维护。</p>
</details>

  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  <br/>
  <div style="text-align: center" >
    <font size="2" color="grey" >本文阅读量&nbsp;<span id="busuanzi_value_page_pv"></span>&nbsp;次</font>
  </div>

<!-- Source file information -->







  
  



<!-- Was this page helpful? -->

  


  



<!-- Comment system -->

  <h2 id="__comments">评论</h2>
  <!-- Insert generated snippet here -->
<script
  src="https://giscus.app/client.js"
  data-repo="JvvYou/jvvyou.github.io"
  data-repo-id="R_kgDOMfCHJg"
  data-category="Announcements"
  data-category-id="DIC_kwDOMfCHJs4ChY4E"
  data-mapping="title"
  data-input-position="top"
  data-reactions-enabled="1"
  data-emit-metadata="1"
  data-theme="light"
  data-lang="zh-CN"
  crossorigin="anonymous"
  async
>
</script>

  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>


<!-- 
<div style="text-align: center" >
  <br/>    
  <p>优雅的赞助一杯绿茶&#128513;</p>
  <img src="/blog/img/person/WechatIMG36353.jpg" alt="觉得有用的老铁们可以微信赞助一杯82年的雪碧呦。" />
  <br/> 
</div>
 -->
      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
        
      
      <nav class="md-footer__inner md-grid" aria-label="页脚" >
        
          
          <a href="../../../01/29/simpleui%20layer%E8%87%AA%E5%8A%A8%E5%8A%A0%E8%BD%BD/" class="md-footer__link md-footer__link--prev" aria-label="上一页: simpleui layer自动加载">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                上一页
              </span>
              <div class="md-ellipsis">
                simpleui layer自动加载
              </div>
            </div>
          </a>
        
        
          
          <a href="../../../06/03/%E5%BD%93%E6%88%91%E9%81%87%E5%88%B0%E4%BA%86%E7%88%AC%E8%99%AB/" class="md-footer__link md-footer__link--next" aria-label="下一页: 当我遇到了爬虫">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                下一页
              </span>
              <div class="md-ellipsis">
                当我遇到了爬虫
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/JvvYou" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../../..", "features": ["navigation.tabs", "navigation.path", "navigation.top", "navigation.indexes", "navigation.footer", "search.suggest", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>